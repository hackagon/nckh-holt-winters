``` r
tonghop <- read.csv("./csv/tonghop_processed.csv", stringsAsFactors = FALSE)
tonghop$dem <- rep(1, nrow(tonghop))
tonghop$xuattrongky_sl[which(is.na(tonghop$xuattrongky_sl))] <- 0
tonghop$xuattrongky_thanhtien[which(is.na(tonghop$xuattrongky_thanhtien))] <- 0

# hoatchat_dvt
tonghop$hoatchat_dvt <- paste(tonghop$hoatchat, tonghop$dvt, sep = "_")
```

Co so thuoc
-----------

**So luong thuoc duoc su dung theo nhom dieu tri tu nam 2014 den 2018 (5 nhom dieu tri co so luong thuoc su dung cao nhat)**

``` r
knitr::kable(nhomdieutri_sl_thuoc, format="html", 
             col.names = c("Nhom DT", "SL thuoc", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL thuoc
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
5334131
</td>
<td style="text-align:right;">
23.410322
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
3723194
</td>
<td style="text-align:right;">
16.340278
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2622209
</td>
<td style="text-align:right;">
11.508296
</td>
</tr>
<tr>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1966145
</td>
<td style="text-align:right;">
8.628976
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
1537847
</td>
<td style="text-align:right;">
6.749271
</td>
</tr>
</tbody>
</table>
``` r
nhomdieutri_hoatchat_nam <- function(vector, namx){
tonghop %>%
  filter(nam == namx) %>%
  group_by(nhomdieutri) %>%
  summarise(sl_hoatchat_ko_hamluong = n_distinct(hoatchat_ko_hamluong))  %>%
  mutate(sl_hoatchat_ko_hamluong_percent = sl_hoatchat_ko_hamluong*100/sum(sl_hoatchat_ko_hamluong)) %>%
  filter(nhomdieutri %in% vector)
}
nhomdieutri_hoatchat_nam_2014 <- nhomdieutri_hoatchat_nam(c(18,7,47,2,48), 2014)
nhomdieutri_hoatchat_nam_2015 <- nhomdieutri_hoatchat_nam(c(18,7,47,2,48), 2015)
nhomdieutri_hoatchat_nam_2016 <- nhomdieutri_hoatchat_nam(c(18,7,47,2,48), 2016)
nhomdieutri_hoatchat_nam_2017 <- nhomdieutri_hoatchat_nam(c(18,7,47,2,48), 2017)
nhomdieutri_hoatchat_nam_2018 <- nhomdieutri_hoatchat_nam(c(18,7,47,2,48), 2018)
```

So luong hoat chat
------------------

**So luong hoat chat duoc su dung theo nhom dieu tri tu nam 2014 den 2018 (5 nhom dieu tri co so luong hoat chat cao nhat)**

``` r
knitr::kable(nhomdieutri_sl_hoatchat, format="html", 
             col.names = c("Nhom DT", "SL hoat chat", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL hoat chat
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
10.989011
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
6.593407
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
6.593407
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
6.227106
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
6.227106
</td>
</tr>
</tbody>
</table>
**So luong hoat chat duoc su dung theo nhom dieu tri tu nam 2014**

``` r
knitr::kable(nhomdieutri_hoatchat_nam_2014, format="html", 
             col.names = c("Nhom DT", "SL hoat chat", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL hoat chat
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
10.970464
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
</tbody>
</table>
**So luong hoat chat duoc su dung theo nhom dieu tri tu nam 2014**

``` r
knitr::kable(nhomdieutri_hoatchat_nam_2014, format="html", 
             col.names = c("Nhom DT", "SL hoat chat", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL hoat chat
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
10.970464
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.751055
</td>
</tr>
</tbody>
</table>
**So luong hoat chat duoc su dung theo nhom dieu tri tu nam 2015**

``` r
knitr::kable(nhomdieutri_hoatchat_nam_2015, format="html", 
             col.names = c("Nhom DT", "SL hoat chat", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL hoat chat
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5.263158
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
5.741627
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
13.397129
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
7.655502
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
5.741627
</td>
</tr>
</tbody>
</table>
**So luong hoat chat duoc su dung theo nhom dieu tri tu nam 2016**

``` r
knitr::kable(nhomdieutri_hoatchat_nam_2016, format="html", 
             col.names = c("Nhom DT", "SL hoat chat", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL hoat chat
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
5.213270
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
5.687204
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
12.322275
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
7.582938
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
5.687204
</td>
</tr>
</tbody>
</table>
**So luong hoat chat duoc su dung theo nhom dieu tri tu nam 2017**

``` r
knitr::kable(nhomdieutri_hoatchat_nam_2017, format="html", 
             col.names = c("Nhom DT", "SL hoat chat", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL hoat chat
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4.390244
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
6.341463
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
12.195122
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
7.317073
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
5.853658
</td>
</tr>
</tbody>
</table>
**So luong hoat chat duoc su dung theo nhom dieu tri tu nam 2018**

``` r
knitr::kable(nhomdieutri_hoatchat_nam_2018, format="html", 
             col.names = c("Nhom DT", "SL hoat chat", "%"))
```

<table>
<thead>
<tr>
<th style="text-align:right;">
Nhom DT
</th>
<th style="text-align:right;">
SL hoat chat
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4.615385
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6.153846
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
13.333333
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
7.692308
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
5.128205
</td>
</tr>
</tbody>
</table>
